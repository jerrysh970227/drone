# 🗺️ 3D 地圖功能使用指南

## ✨ 功能概述
您的無人機應用現在支援 Google Maps 3D 功能！此功能只在全螢幕地圖中啟用，提供更好的空間感知和飛行路徑規劃。

## 🚀 如何使用

### 1. 開啟全螢幕地圖
- 點擊小地圖右上角的 🔍 全螢幕圖示
- 或者點擊小地圖的任何位置

### 2. 啟用 3D 模式
在全螢幕地圖中：
- 點擊頂部工具列的 🔄 3D 圖示
- 圖示會變為綠色表示 3D 模式已啟用
- 地圖標題會顯示 "無人機 3D 地圖"

### 3. 3D 功能特色

#### 📱 視圖控制
- **傾斜視角**: 自動設定 45° 傾斜角度，提供立體視覺
- **3D 建築物**: 顯示真實的 3D 建築物模型
- **手勢控制**: 
  - 雙指拖拽可調整傾斜角度 (0-60°)
  - 旋轉手勢可改變視角方向
  - 一般的縮放和拖拽功能保持不變

#### 🎯 位置標記
- **藍色標記**: 手機位置 📱
- **紅色標記**: 無人機位置 ✈️
- 點擊標記可查看詳細資訊

#### 🛠️ 工具列功能
- **🔄 3D 切換**: 啟用/關閉 3D 模式
- **🛰️ 衛星切換**: 標準地圖 ↔ 衛星影像
- **📍 定位按鈕**: 重新定位到手機位置
- **❌ 關閉按鈕**: 回到主畫面

#### 🎮 3D 控制按鈕
當 3D 模式啟用時，右下角會出現：
- **🔄 3D 視角按鈕**: 重新調整到最佳 3D 視角

## 🎯 無人機應用優勢

### ✈️ 飛行路徑規劃
- **建築物避障**: 3D 建築物可視化幫助規劃安全路徑
- **地形感知**: 清楚看到高度變化和地形特徵
- **降落區選擇**: 立體視角更容易識別適合的降落地點

### 🌍 地圖類型
- **標準地圖**: 清楚的道路和地標標示
- **衛星影像**: 真實的衛星照片，適合戶外飛行
- **中文地名**: 所有地名都使用繁體中文顯示

## ⚙️ 技術要求

### 📋 權限需求
- **位置權限**: 顯示手機位置
- **網路權限**: 載入地圖資料

### 🔑 Google Maps API
- 需要有效的 Google Maps API 金鑰
- 在 AndroidManifest.xml 中設定：`YOUR_GOOGLE_MAPS_API_KEY`

### 📱 系統需求
- Android: 啟用硬體加速
- 穩定的網路連線

## 🔧 故障排除

### ⚠️ 常見問題

#### 1. **地圖黑屏/無法載入 3D 地圖**
**症狀**: 點擊 3D 模式後出現黑屏
**原因**: Google Maps 插件未正確註冊
**解決方案**:
- 應用會自動回退到 2D 地圖模式
- 檢查 Google Maps API 金鑰是否正確設定
- 確認網路連線正常

#### 2. **位置獲取超時**
**症狀**: 顯示 "TimeoutException after 0:00:10.000000"
**解決方案**:
- 應用會自動使用預設位置（台北）
- 確認位置權限已開啟
- 在開闊地區重新嘗試
- 檢查 GPS 信號強度

#### 3. **3D 效果不明顯**
**解決方案**:
- 使用手勢調整傾斜角度
- 點擊 3D 視角按鈕重新調整
- 切換到衛星視圖查看建築物

#### 4. **插件註冊錯誤**
**症狀**: "Trying to create a platform view of unregistered type"
**解決方案**:
- 重新編譯應用：`flutter clean && flutter pub get`
- 確認 MainActivity.kt 已正確配置
- 檢查 Google Maps 依賴是否正確安裝

### 🛡️ 回退機制
- 當 Google Maps 3D 無法載入時，應用會自動切換到 FlutterMap 2D 模式
- 位置獲取失敗時會使用預設位置（台北市中心）
- 所有核心功能都有備用方案確保應用穩定運行

### 📞 技術支援
如有任何問題，請檢查：
- Flutter 控制台日誌
- GPS 權限設定
- 網路連線狀態
- Google Maps API 配置

## 📋 故障診斷清單

### ✅ 在報告問題前請檢查：
1. **權限設定**:
   - [ ] 位置權限已授權
   - [ ] 網路權限正常
   
2. **API 配置**:
   - [ ] Google Maps API 金鑰已設定
   - [ ] AndroidManifest.xml 配置正確
   
3. **環境檢查**:
   - [ ] 網路連線穩定
   - [ ] GPS 信號良好
   - [ ] 硬體加速已啟用

4. **應用狀態**:
   - [ ] 重新啟動應用
   - [ ] 清理並重新編譯
   - [ ] 檢查控制台錯誤訊息

---
**享受您的 3D 無人機地圖體驗！** 🚁✨